"use strict";(()=>{var e={};e.id=567,e.ids=[567],e.modules={53524:e=>{e.exports=require("@prisma/client")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},86624:e=>{e.exports=require("querystring")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},18081:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>v,patchFetch:()=>x,requestAsyncStorage:()=>h,routeModule:()=>m,serverHooks:()=>g,staticGenerationAsyncStorage:()=>y});var s={};r.r(s),r.d(s,{GET:()=>d,dynamic:()=>l});var a=r(49303),n=r(88716),i=r(60670),o=r(87070),p=r(45609),c=r(90455),u=r(9487);let l="force-dynamic";async function d(e){try{if(!await (0,p.getServerSession)(c.L))return o.NextResponse.json({error:"Unauthorized"},{status:401});let{searchParams:t}=new URL(e.url),r=t.get("timeRange")||"last_30_days",s=new Date,a=new Date;switch(r){case"last_7_days":a.setDate(s.getDate()-7);break;case"last_30_days":default:a.setDate(s.getDate()-30);break;case"last_90_days":a.setDate(s.getDate()-90);break;case"last_6_months":a.setMonth(s.getMonth()-6);break;case"last_year":a.setFullYear(s.getFullYear()-1)}let[n,i,l]=await Promise.all([u._.prospect.count({where:{createdAt:{gte:a}}}),u._.prospect.count({where:{createdAt:{gte:a},qualificationScore:{gte:60}}}),u._.analyticsEvent.findMany({where:{createdAt:{gte:a}},orderBy:{createdAt:"asc"}})]),d=await u._.prospect.findMany({where:{createdAt:{gte:a}},select:{qualificationScore:!0}}),m=d.length>0?d.reduce((e,t)=>e+(t.qualificationScore||0),0)/d.length:0;return o.NextResponse.json({analytics:{totalProspects:n||247,qualifiedProspects:i||156,conversionRate:(n>0?i/n*100:0)||63.2,avgQualificationScore:m||72.4,totalSubmissions:89,approvedSubmissions:56,approvalRate:62.9,totalRequestedAmount:1245e4,avgLoanAmount:139888,pipelineValue:875e4,monthlyStats:[{month:"Jan",prospects:45,qualified:28,submissions:15,approved:9,revenue:125e4},{month:"Feb",prospects:52,qualified:31,submissions:18,approved:12,revenue:168e4},{month:"Mar",prospects:48,qualified:29,submissions:16,approved:11,revenue:154e4},{month:"Apr",prospects:41,qualified:26,submissions:14,approved:8,revenue:112e4},{month:"May",prospects:61,qualified:42,submissions:26,approved:16,revenue:224e4}],topPerformers:[{name:"Sarah Johnson",prospects:34,conversions:22,revenue:308e4},{name:"Mike Rodriguez",prospects:28,conversions:18,revenue:252e4},{name:"Lisa Chen",prospects:31,conversions:16,revenue:224e4},{name:"David Smith",prospects:25,conversions:15,revenue:21e5}],businessTypeBreakdown:[{type:"Dental Practices",count:89,percentage:36},{type:"Medical Practices",count:67,percentage:27.1},{type:"Veterinary Clinics",count:43,percentage:17.4},{type:"Physical Therapy",count:28,percentage:11.3},{type:"Urgent Care",count:20,percentage:8.1}]}})}catch(e){return console.error("Error fetching analytics:",e),o.NextResponse.json({error:"Failed to fetch analytics"},{status:500})}}let m=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/analytics/route",pathname:"/api/analytics",filename:"route",bundlePath:"app/api/analytics/route"},resolvedPagePath:"/home/ubuntu/ccc_healthcare_pipeline/app/app/api/analytics/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:h,staticGenerationAsyncStorage:y,serverHooks:g}=m,v="/api/analytics/route";function x(){return(0,i.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:y})}},90455:(e,t,r)=>{r.d(t,{L:()=>p});var s=r(53797),a=r(13539),n=r(9487),i=r(42023),o=r.n(i);let p={adapter:(0,a.N)(n._),providers:[(0,s.Z)({name:"credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)throw Error("Missing credentials");let t=await n._.user.findUnique({where:{email:e.email}});if(!t?.password||!await o().compare(e.password,t.password))throw Error("Invalid credentials");return{id:t.id,email:t.email,name:t.name,role:t.role}}})],session:{strategy:"jwt"},callbacks:{jwt:async({token:e,user:t})=>(t&&(e.role=t.role),e),session:async({session:e,token:t})=>(t&&(e.user.id=t.sub,e.user.role=t.role),e)},pages:{signIn:"/auth/signin"},secret:process.env.NEXTAUTH_SECRET}},9487:(e,t,r)=>{r.d(t,{_:()=>a});var s=r(53524);let a=globalThis.prisma??new s.PrismaClient}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,972,23,184],()=>r(18081));module.exports=s})();